类型
=====

## 指针

### 指针值

指针的值（即地址）应属下列4种状态之一：

1. 指向一个对象
2. 指向紧邻对象所占空间的下一个位置
3. 空指针，意味着指针没有指向任何对象
4. 无效指针，也就是上述情况之外的其他值

### 空指针

初始化

1. ``int *p1 = nullptr`` // c++11引入，最佳
2. ``int *p2 = 0``
3. 首先 ``#include cstdlib`` 然后 ``int *p3 = NULL`` // 等价于 ``*p3 = 0``

注意：把``int``变量直接赋给指针是错误的操作，即使``int``变量的值恰好等于``0``也不行

建议：初始化所有指针

### 其他指针操作

注意：在条件表达式中，任何非``0``指针对应的条件值都是``true``

两个指针存放的地址值相同（两个指针相等）有三种可能：

1. 它们都为空
2. 都指向同一个对象
3. 都指向了同一个对象的下一个地址
4. 一个指针指向某对象，同时另一个指针指向另外对象的下一个地址，也可能会相等

### void* 指针

一种特殊的指针类型，可用于存放任意对象的地址。

利用``void*``指针能做的事比较有限：拿它和别的指针比较、作为函数的输入或输出，或者赋给另外一个``void*``指针。不能直接操作``void*``指针所指的对象，因为我们并不知道这个对象到底是什么类型，也就无法确定能在这个对象上做哪些操作。

概括来说，以``void*``的视角来看内存空间也就仅仅是内存空间，没办法访问内存空间中所存的对象。

### 指向指针的指针、指向指针的引用

面对一条比较复杂的指针或引用的声明语句时，**从右向左**阅读有助于弄清楚它的真实含义

## const 限定符

```cpp
const int i = get_size(); // 运行时初始化
const int j = 42;         // 编译时初始化
```

### 作用域

1. 默认状态下，``const``对象仅在文件内有效
2. 如果想要只在一个文件中定义``const``，而在其他多个文件中声明并使用它。那么不管时声明还是定义都添加``extern``关键字。这样只需要定义一次就可以了

### 对const的引用（常量引用）

1. 与普通引用不同的是，对常量的引用不能被用作修改它所绑定的对象
2. 不能用一个非常量引用指向一个常量对象
3. 引用的类型必须与其所引用对象的类型一致

### 指针和const

指向常量的指针不能用于改变其所指对象的值。要想存放常量对象的地址，只能使用指向常量的指针。

### const指针

指针是对象而引用不是，因此就像其他对象类型一样，允许把指针本身定为常量。常量指针必须初始化，而且一旦初始化完成，则它的值（也就是存放在指针中的那个地址）就不能再改变了。

### 顶层const

指针本身是一个对象，它又可以指向另外一个对象。因此，指针本身是不是常量以及指针所指的是不是一个常量就是两个相互独立的问题。

- 顶层const：表示指针本身是个常量
- 底层const：表示指针所指的对象是一个常量

### constexpr和常量表达式

指值不会改变并且在编译过程就能得到计算结果的表达式。一个对象（或表达式）是不是常量表达式由它的数据类型和初始值共同决定。

c++11规定，允许将变量声明为``constexpr``类型以便由编译器来验证变量的值是否是一个常量表达式。

## 处理类型

### 类型别名

- typedef
- using (c++11)

### auto类型说明符

让编译器替我们去分析表达式所属的类型，必须有初始值。

### decltype类型指示符

希望从表达式的类型推断出要定义的变量的类型，但是不想用该表达式的值初始化变量。为了满足这一要求，c++11引入了第二种类型说明符decltype，它的作用是选择并返回操作数的数据类型。在此过程中，编译器分析表达式并得到它的类型，却不实际计算表达式的值

## 自定义数据结构

### 编写自己的头文件

头文件一旦改变，相关的源文件必须重新编译以获取更新过的声明。

### 预处理器

确保头文件多次包含仍能安全工作的常用技术是预处理器，它由C++语言从C语言继承而来。预处理器是在编译之前执行的一段程序，可以部分地改变我们所写的程序。

头文件保护符

- define
- ifdef
- ifndef
- endif

注意：

1. 预处理器变量无视C++语言中关于作用域的规则
2. 整个程序中的预处理变量包括头文件保护符必须唯一，通常的做法是基于头文件中类的名字来构建保护符的名字，以确保其唯一性。为了避免与程序中的其他实体发生名字冲突，一般把预处理变量的名字全部大写。

**最佳实践**：头文件即使（目前还）没有被包含在任何其他头文件中，也应该设置保护符。头文件保护符很简单，程序员只要习惯性地加上就可以了，没必要太在乎你的程序到底需不需要。
